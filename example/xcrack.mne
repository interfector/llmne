#!/usr/local/bin/llmne -x

_START:

STPUSH PUSHED
CALL READL

SAVE GAP

JMP CLOOP

#STPUSH PUSHED+1
#CALL PRINT

EXIT 0

# READL function starts

READL:

SUBSP 1

DISPLAY CHAR
STPOP LOOP
LOAD LOOP
ADD GAP
SAVE LOOP+1
SAVE GAP

LOOP:
READ STRING
LOAD STRING

CMP EOT
JZ END

INC LOOP
INC LOOP+1

JMP LOOP

END:

ADDSP 1

DISPLAY INT
LOAD LOOP+1
SUB GAP
RET

GAP:
0300 # difference between 'PUSH 00' and 'READ 00'

EOT:
0010

# READL function ends

# PRINT function starts

PRINT:

SUBSP 1

DISPLAY CHAR
STPOP PLOOP

PLOOP:

LOAD PLOOP
CMP NULL
JZ ENDP

SAVE $$+4
WRITE $$+3

INC PLOOP

JMP PLOOP
NOP

NULL:
0000

ENDP:
ADDSP 1 
DISPLAY INT
RET

# PRINT function ends

PUSHED:
READ STRING
LOAD STRING
LOAD GOAL
LOAD NGOAL

NGOAL:
0078 'N'
0111 'o'
0116 't'
0032 ' '
GOAL:
0080 'P'
0097 'a'
0115 's'
0115 's'
0101 'e'
0100 'd'
0010 '\n'
0000

PASS:
0111 'o'
0108 'l'
0093 ']'
0052 '4'
0036 '$'
0096 '`'
0010 '\n'
0000

CLOOP:
LOAD PASS
CMP NULL
JZ OK

CMP STRING
JN NOK

INC CLOOP
INC CLOOP+3

JMP CLOOP

OK:
STPUSH PUSHED+2
CALL PRINT

EXIT 0

NOK:

STPUSH PUSHED+3
CALL PRINT

EXIT 1

STRING:
0000
0
0
0
0
0
0
0
0
0
0

