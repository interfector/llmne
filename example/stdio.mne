# Symbols

NULL:
0000

EOT:
NEWLINE:
0010 '\n'

# READL function starts

READL:

SUBSP 1

DISPLAY CHAR
STPOP READ_LOOP
PUSH READ_LOOP
ADD RGAP
POP READ_LOOP+1
POP COUNT

READ_LOOP:
READ STRING
PUSH STRING

CMP EOT
JZ READ_END

INC READ_LOOP
INC READ_LOOP+1

JMP READ_LOOP

READ_END:
PUSH READ_LOOP+1
SUB COUNT
ADDSP 1
DISPLAY INT
RET

RGAP:
0300 # difference between 'PUSH 00' and 'READ 00'

COUNT:
0000

# READL function ends

# PRINT function starts

PRINT:

SUBSP 1

DISPLAY CHAR
STPOP PRINT_LOOP

PRINT_LOOP:

PUSH PRINT_LOOP
CMP NULL
JZ END_PRINT

POP $$+4
WRITE $$+3

INC PRINT_LOOP

JMP PRINT_LOOP
NOP

END_PRINT:
ADDSP 1
DISPLAY INT
RET

# PRINT function ends

# ATOI function starts

ATOI:

SUBSP 1

STPOP ATOI_LOOP

ATOI_LOOP:

PUSH ATOI_LOOP
CMP NULL
JZ ATOI_END

CMP ATOI_LIMIT
JM ATOI_LOOP_END

CMP ATOI_LIMIT+1
JG ATOI_LOOP_END

SUB ATOI_LIMIT
POP ATOI_NUMBER+1

PUSH ATOI_NUMBER
MUL ATOI_NUMBER+2
ADD ATOI_NUMBER+1
POP ATOI_NUMBER

ATOI_LOOP_END:

INC ATOI_LOOP

JMP ATOI_LOOP

ATOI_END:
PUSH ATOI_NUMBER
ADDSP 1
RET

ATOI_LIMIT:
48 '0'
57 '9'

ATOI_NUMBER:
0000
0000
0010

# ATOI function ends
