#!/usr/local/bin/llmne -x
# Self Modifiying Code on LXS ( XOR Encording 0x1 byte )
# Payload size: 15 instruction
# Adds 15 to all variable and symbols relocations

BYTE:
0001

END:
0000

LEN:
0004

_START:

PUSH LOOP
DEC LEN
ADD LEN
POP END

LOOP:

PUSH SHELLCODE
XOR BYTE
POP SHELLCODE

PUSH LOOP
CMP END
JZ SHELLCODE

INC LOOP
INC LOOP+2

JMP LOOP

SHELLCODE:
1018 # READ I
3400 # CHMOD HEX
1118 # WRITE I
0001 # I
