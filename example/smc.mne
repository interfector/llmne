#!/usr/local/bin/llmne -x
# Self Modifiying Code on LXS ( XOR Encoding 0x1 byte )
# Payload size: 16 instruction
# Adds 16 to all variable and symbols relocations

@ECHO SelfModifying code ( XOR encoding ) 

BYTE:
0001

END:
0000

LEN:
0004

_START:

PUSH LOOP
DEC LEN
ADD LEN
POP END

LOOP:

PUSH SHELLCODE
XOR BYTE
POP SHELLCODE

PUSH LOOP
CMP END
JZ SHELLCODE

INC LOOP
INC LOOP+2

JMP LOOP

SHELLCODE:
0001 # I
1017 # READ I
3400 # CHMOD HEX
1117 # WRITE I
